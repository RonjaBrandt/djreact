{% extends "base.html" %}
{% comment "template_location" %}
    'survey/ajax.html'
{% endcomment %}
{% block content %}
    <form class='my-ajax-form' method='POST' action='.' data-url='survey/test/'>
        {% csrf_token %}
        {{form.as_p|safe}}
        <button type='submit'>Submit</button>
    </form>
{% endblock content %}

{% block javascript %}
<script>
        $(document).ready(function(){
            var $myForm = $('.my-ajax-form')
            $myForm.submit(function(event){
                event.preventDefault()
                var $formData = $(this).serialize()
                var $endpoint = $myForm.attr('data-url')
                $.ajax({
                    method: "POST",
                    url: $endpoint,
                    data: $formData,
                    success: handleFormSuccess,
                    error: handleFormError,
                })
            })
        
            function handleFormSuccess(data, textStatus, jqXHR){
                console.log(data)
                console.log(textStatus)
                console.log(jqXHR)
                $myForm.reset[0]; // reset form data
            }
        
            function handleFormError(jqXHR, textStatus, errorThrown){
                console.log(jqXHR)
                console.log(textStatus)
                console.log(errorThrown)
            }
        })
</script>
{% endblock javascript %}